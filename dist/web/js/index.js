(()=>{"use strict";var t={836:t=>{function e(t){var n={},o=this;this.getRegistry=function(){var t={};for(var e in n)n[e].builtin||(t[e]=n[e]);return t},this.setRegistry=function(t){for(var e in t)n[e]=t[e];return o};var r={},i={};function s(t){if(t=t&&t.toUpperCase(),i[t])return i[t].evaluated?i[t].evaluated:void 0}this.putModule=function(t,e,n){var o={html:r,js:i};t=t.toUpperCase(),o[n]&&(o[n][t]=e)};var a=e.document||window.document,h={};this.getShared=function(){return h},this.findLocalPrep=function(t){var e=(t+"").toUpperCase();return n[e]&&n[e].prep?n[e].prep:void 0},this.findPrep=function(t){var e;if(e=this.findLocalPrep(t))return e;var n=(t+"").toUpperCase().split(":");return n.length>1&&r[n[0]]?r[n[0]].findPrep(n.slice(1).join(":")):void 0};var c=function(e,n){var r=o.findLocalPrep(n);r&&(r.superc&&c(e,r.superc),r.script&&(e.__=r.script,e.__(t,o,a,s),e.onCreate()))};function l(t,e){if(e&&t&&t.setAttribute)for(var n in e)t.setAttribute(n,e[n])}function u(t){var e={};e.tgn=t.getAttribute("tagname")||t.tagName,e.as=t.getAttribute("as"),e.attr=function(t){for(var e={},n=0;n<t.length;n++)e[t[n].name.toLowerCase()]=t[n].value;return e}(t.attributes),e.attr.ref&&(e.attr._ref=e.attr.ref,delete e.attr.ref),e.ch=[],e.superc=t.getAttribute("super")||void 0;for(var n=t.childNodes,r=0;r<n.length;r++){var i=n[r],s=i.textContent||i.innerHTML||i.nodeValue||"";if(!(i.nodeType>3))if(i.tagName){var a=i.tagName.toUpperCase();if("CONSTRUCTOR"===a||"SCRIPT"===a){var h=(o.src?"/*"+t.outerHTML.replace(s,"see script below").replace("*/","*\\/")+"*/\n":"")+s+(o.src?"\n//# sourceURL=W3View:///"+o.src+"<"+e.as+">":"");e.script=new Function("appContext,factory,document,require",h)}else{var c=u(i);delete c.script,delete c.as,e.ch.push(c)}}else s.trim()&&e.ch.push(s)}return e}this.parse=function(t){var e=a.createElement("div");e.innerHTML=t;var n=e.children;return n.length?(this.register(n),this):t},this.register=function(t){for(var e=0;e<t.length;e++)this.registerElement(t[e])},this.registerElement=function(t){if("IMPORT"===t.tagName.toUpperCase()&&t.getAttribute("type")){var e=t.getAttribute("type").toLowerCase();"html"!==e&&"js"!==e||(this.imports=this.imports||[],this.imports.push({type:e,src:t.getAttribute("src"),name:t.getAttribute("as")}))}else{var o=(t.getAttribute("as")||"").toUpperCase();if(o){if(n[o])throw new Error(o+" - is already registered component");var r=u(t);n[o]={},n[o].prep=r}}},this.create=function(t,n,i,s){var h;n=n||{},i=i||[];var u=this.findLocalPrep(t);if(u)if(this.findPrep(u.tgn)){var d=e.mix(e.mix({},u.attr),n.usetag?{usetag:n.usetag}:{});h=this.create(u.tgn,d,u.ch)}else h=function(t,e){var n=a.createElement(t);if(n.as=e.as,n.ref={content:n},l(n,e.attr),e.ch&&e.ch.length)for(var r=0;r<e.ch.length;r++)if(e.ch[r].tgn){var i=o.create(e.ch[r].tgn,e.ch[r].attr,e.ch[r].ch,n),s=i.getAttribute("_ref");s&&(n.ref[s]=i),n.appendChild(i),i.onMount&&i.onMount()}else n.appendChild(a.createTextNode(e.ch[r]));return n}(n.usetag||u.tgn,u);else{var f=t.toUpperCase().split(":");f.length>1&&r[f[0]]?(h=r[f[0]].create(f.slice(1).join(":"),n)).fullTgn=t:h=a.createElement(t),h.ref=h.ref||{content:h}}if(s||(s=h),l(h,n),i&&i.length)for(var g=0;g<i.length;g++)if(i[g].tgn){var p=this.create(i[g].tgn,i[g].attr,i[g].ch,s),m=p.getAttribute("_ref");m&&(s.ref=s.ref||{},s.ref[m]=p),p.mount?p.mount(h):h.ref.content.appendChild(p)}else h.ref.content.appendChild(a.createTextNode(i[g]));var x=e.mixin;return u&&(e.mix(h,x,!0),c(h,t)),h.destroy=x.destroy,h},this.byExample=function(t){if(!t.as)throw new Error("Sample should be registered component");for(var e={},n=0;n<t.attributes.length;n++){var o=t.attributes[n];t[o.name]&&"function"==typeof t[o.name]||(e[o.name]=o.value)}return this.create(t.fullTgn||t.as,e)},n["ARRAY-ITERATOR"]={prep:{tgn:"DIV",as:"ARRAY-ITERATOR",attr:{as:"ARRAY-ITERATOR"}}},n["ARRAY-ITERATOR"].builtin=!0,this.findLocalPrep("ARRAY-ITERATOR").script=function(t,e){for(var n=[];this.children.length>0;)n.push(this.removeChild(this.children[0]));this.onSetData=function(t,o){t||(t=[]),Array.isArray(t)||(t=[t]);for(var r=0;r<t.length||r<this.children.length;r++)if(this.children[r]&&t.length<=r)this.children[r].destroy(),r--;else{var i=t[r],s=this.children[r];s||(s=e.byExample(n[r%n.length])).mount(this),s.setData(i,o,r)}}}}String.prototype.trim=String.prototype.trim||function(){return this},e.mix=function(t,e,n){for(var o in t=t||{},e=e||{})t[o]=(n?t[o]:null)||e[o];return t},e.mixin={},e.mixin.start=function(){this.onStart&&this.onStart();for(var t=0;this.children&&t<this.children.length;t++){var n=this.children[t];n.start=n.start||e.mixin.start,n.start()}},e.mixin.stop=function(){this.onStop&&this.onStop();for(var t=0;this.children&&t<this.children.length;t++){var n=this.children[t];n.stop=n.stop||e.mixin.stop,n.stop()}},e.mixin.onStart=function(){},e.mixin.onStop=function(){},e.mixin.mount=function(t,e){t=t.ref&&t.ref.content?t.ref.content:t,this.unmount(),void 0===e||t.childNodes.length<=e?t.appendChild(this):t.insertBefore(this,t.childNodes[e<0?0:e]),this.onMount()},e.mixin.unmount=function(){this.parentNode&&(this.onUnmount(),this.parentNode.removeChild(this))},e.mixin.setData=function(t,e,n){this.onSetData(t,e,n)},e.mixin.destroy=function(){for(this.unmount?this.unmount():this.parentNode.removeChild(this),this.onDestroy&&this.onDestroy(),this.onStop&&this.onStop();this.children.length;)this.children[0].destroy||(this.children[0].destroy=e.mixin.destroy),this.children[0].destroy()},e.mixin.onSetData=function(t,e){},e.mixin.onMount=function(){},e.mixin.onUnmount=function(){},e.mixin.onCreate=function(){},e.mixin.onDestroy=function(){},t.exports=e}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{const t="end";function e(e){const n={apiVerion:"1.0",enterState:e.documentElement.getAttribute("start-state"),terminator:t,description:"",properties:{},states:{}},r=e.getElementsByTagName("state");for(let t=0;t<r.length;t++){let e=r[t],i={type:"decision",connectors:[],external:{}};o(e,i),n.states[e.getAttribute("name")]={type:i.type,description:e.getAttribute("title"),properties:{},connectors:i.connectors},Object.keys(i.external).forEach((t=>{n.states[t]?i.external[t].connectors.forEach((e=>{n.states[t].connectors.push(e)})):n.states[t]=i.external[t]}))}return n}function o(e,n){const o={},r=[];for(let t=0;t<e.childNodes.length;t++){let o=e.childNodes.item(t);if("event"!==o.tagName)if("state-transition"!==o.tagName){if("flow-transition"===o.tagName){n.external=n.external||{};let t=o.getAttribute("subflow");n.external["#"+t]={type:"external",description:"",properties:{},connectors:[{name:"#return",to:e.getAttribute("name")}]},i({name:o.getAttribute("name"),to:"#"+t})}}else i({name:o.getAttribute("name"),to:o.getAttribute("to")});else n.type="process"}function i(t){o[t.to]?o[t.to].name+=", "+t.name:(o[t.to]=t,r.push(t))}r.length<=1&&"decision"===n.type&&(n.type="process"),!r.length&&i({name:"#link?",to:t}),r.forEach((t=>n.connectors.push(t)))}let r,i;function s(t,e,n,o,r,i){t.beginPath(),t.lineWidth=2,t.strokeStyle="#003300",t.rect(a(n,o,r,i),h(n,o,r,i),i.width,i.height),t.stroke(),function(t,e,n){t.beginPath(),t.arc(e,n,4,0,2*Math.PI,!1),t.fillStyle="#ffffff",t.fill(),t.strokeStyle="#003300",t.stroke()}(t,e.outgoingArrows[0].x,e.outgoingArrows[0].y),function(t,e,n){t.beginPath(),t.arc(e,n,4,0,2*Math.PI,!1),t.fillStyle="#000000",t.fill(),t.strokeStyle="#003300",t.stroke()}(t,e.incomingArrows[0].x,e.incomingArrows[0].y);let s=c(n,o,r,i),u=l(n,o,r,i)+45;t.font="14px Arial",t.fillStyle="#000000",t.fillText(e.name,s,u)}function a(t,e,n,o){let i=2*Math.PI/e*(t+1),s=r.height/2-n.offset;return n.x+s*Math.cos(i)-o.width/2}function h(t,e,n,o){let i=2*Math.PI/e*(t+1),s=r.height/2-n.offset;return n.x+s*Math.sin(i)-o.height/2}function c(t,e,n,o){return a(t,e,n,o)+5}function l(t,e,n,o){return h(t,e,n,o)-25}function u(t,e,n,o){t.stateColumns[e][n].rectCoordinateX=t.stateBounds.width+t.stateBounds.width*e*2,t.stateColumns[e][n].rectCoordinateY=(t.bounds.y-(2*t.stateColumns[e].length-1)*t.stateBounds.height)/2+t.stateBounds.height*n*2,t.stateColumns[e][n].cellPositionX=e,t.stateColumns[e][n].cellPositionY=n,o.beginPath(),o.lineWidth=2,o.strokeStyle="#000000",o.rect(t.stateColumns[e][n].rectCoordinateX,t.stateColumns[e][n].rectCoordinateY,t.stateBounds.width,t.stateBounds.height),o.stroke(),o.font="14px Arial",o.fillStyle="#000000",o.fillText(t.stateColumns[e][n].name,t.stateColumns[e][n].rectCoordinateX+10,t.stateColumns[e][n].rectCoordinateY+15)}function d(t,e,n){t.srcColNum>t.destColNum?(t.srcY-=e.stateBounds.height/3.5,t.destY-=e.stateBounds.height/3.5):t.srcColNum<t.destColNum&&(t.srcY+=e.stateBounds.height/3.5,t.destY+=e.stateBounds.height/3.5);let o=t.srcColNum<t.destColNum?t.srcX+t.connectorCentralOffsetX+.65*e.stateBounds.width:t.srcX+t.connectorCentralOffsetX-.65*e.stateBounds.width;n.beginPath(),n.moveTo(t.srcX,t.srcY),n.lineTo(o,t.srcY),n.stroke(),n.beginPath(),n.moveTo(o,t.srcY),n.lineTo(o,t.destY),n.stroke(),n.beginPath(),n.moveTo(o,t.destY),n.lineTo(t.destX,t.destY),n.stroke();const r=t.srcColNum<t.destColNum?0:Math.PI;n.beginPath(),n.moveTo(t.destX,t.destY),n.lineTo(t.destX-20*Math.cos(r-Math.PI/7),t.destY-20*Math.sin(r-Math.PI/9)),n.stroke(),n.beginPath(),n.moveTo(t.destX,t.destY),n.lineTo(t.destX-20*Math.cos(r+Math.PI/7),t.destY-20*Math.sin(r+Math.PI/9)),n.stroke()}function f(t,e,n){if(!t)return e.createTextNode("");if("object"!=typeof t)return e.createTextNode(t);const o=n&&e.createElementNS(n,t.tag)||e.createElement(t.tag);return Object.keys(t.attributes||{}).forEach((e=>{o.setAttribute(e,t.attributes[e])})),t.children?.forEach((t=>{o.appendChild(f(t,e,n))})),o}const g={gridSize:5,shapeHeight:40,shapeWidth:80,strokeColor:"#000000",bgColor:"#CCCCFF",textColor:"#000000",fontFace:"sans-serif",fontSize:10},p={};function m(t,e,n=g){const o={};Object.keys(g).forEach((t=>{o[t]=n[t]+""&&n[t]||g[t]}));const r=[0,0];this.getShapes=()=>p,this.position=(t,e)=>(r[0]=t,r[1]=e,this),this.render=()=>{if(!e)return;const n=p[e.type](t,e,o);return n.attributes.id="state-"+e.type+"/"+t,n.attributes.transform="translate("+r.join(" ")+")",n.x=r[0],n.y=r[1],n}}p.process=(t,e,n=g)=>{const o=n.shapeWidth,r=n.shapeHeight;return{width:o,height:r,tag:"g",attributes:{transform:"translate(0 0)"},children:[{tag:"rect",attributes:{x:0,y:0,width:o,height:r,rx:.5*n.gridSize,ry:.5*n.gridSize,fill:n.bgColor,stroke:n.strokeColor}},{tag:"text",attributes:{x:n.gridSize,y:3*n.gridSize,fill:n.textColor,"font-size":n.fontSize,"font-family":n.fontFace},children:[t]},{tag:"text",attributes:{x:n.gridSize,y:5*n.gridSize,"font-size":n.fontSize,"font-family":n.fontFace},children:[e.description&&"("+e.description+")"]}]}},p.decision=(t,e,n=g)=>{const o=n.shapeWidth,r=n.shapeHeight;return{width:16*n.gridSize,height:8*n.gridSize,tag:"g",attributes:{transform:"translate(0 0)"},children:[{tag:"path",attributes:{d:["M",0,r/2,"L",o/2,0,"L",o,r/2,"L",o/2,r,"z"].join(" "),fill:n.bgColor,stroke:n.strokeColor}},{tag:"text",attributes:{x:4*n.gridSize,y:3*n.gridSize,fill:n.textColor,"font-size":n.fontSize,"font-family":n.fontFace},children:[t]},{tag:"text",attributes:{x:4*n.gridSize,y:5*n.gridSize,"font-size":n.fontSize,"font-family":n.fontFace},children:[e.description&&"("+e.description+")"]}]}},p.external=(t,e,n=g)=>{const o=n.shapeWidth,r=n.shapeHeight;return{width:o,height:r,tag:"g",attributes:{transform:"translate(0 0)"},children:[{tag:"path",attributes:{d:["M",0,0,"L",o-2*n.gridSize,0,"L",o,r/2,"L",o-2*n.gridSize,r,"L",0,r,"z"].join(" "),fill:n.bgColor,stroke:n.strokeColor}},{tag:"text",attributes:{x:n.gridSize,y:3*n.gridSize,fill:n.textColor,"font-size":n.fontSize,"font-family":n.fontFace},children:[t]},{tag:"text",attributes:{x:n.gridSize,y:5*n.gridSize,"font-size":n.fontSize,"font-family":n.fontFace},children:[e.description&&"("+e.description+")"]}]}},p.enter=p.end=(t,e,n=g)=>{const o=12*n.gridSize,r=3*n.gridSize,i=r/2;return{width:o,height:r,tag:"g",attributes:{transform:"translate(0 0)"},children:[{tag:"path",attributes:{d:["M",i,0,"L",o-i,0,"A",i,i,0,0,1,o-i,r,"L",i,r,"A",i,i,0,0,1,i,0].join(" "),fill:"white",stroke:n.strokeColor}},{tag:"text",attributes:{x:n.gridSize,y:2*n.gridSize,fill:n.textColor,"font-size":n.fontSize,"font-family":n.fontFace},children:[t]}]}};const x={rowHeight:60,columnWidth:80,turnRadius:15,marginLeft:10,marginTop:10,textBoxLength:15,gridSize:5,shapeHeight:40,shapeWidth:80,strokeColor:"#000000",bgColor:"#CCCCFF",textColor:"#000000",fontFace:"sans-serif",fontSize:10};function y(t,e,n=x){const o={};Object.keys(x).forEach((t=>{o[t]=n[t]+""&&n[t]||x[t]}));const r={tag:"g",attributes:{transform:"translate(0 0)"},children:[]},i={tag:"svg",attributes:{version:"1.1",xmlns:"http://www.w3.org/2000/svg"},children:[r]},s=[],a={};let h=[];function c(e,n,i,d,f){let g=t.states[n],p=!1;if(!g){if(n!==t.terminator)return void console.warn("State ["+n+"] not found");g={type:"end"},p=!0}const x=new m(n,g,o).position(d*o.columnWidth,i*o.rowHeight).render();x.joins=l(x),!p&&(a[n]=x),h[d]=[{s:i,e:i}],s[i]=x,x.column=d,x.row=i,r.children.push(x),r.children.push(u(e,x,f)),g.connectors?.forEach((t=>{let e=t.to;a[e]?r.children.push(u(x,a[e],t.name)):c(x,e,s.length,d+1,t.name)}))}function l(t){const e=t.x,n=t.y,o=t.width,r=t.height;return{left:{x:e,y:n+r/2},bottom:{x:e+o/2,y:n+r},right:{x:e+o,y:n+r/2},top:{x:e+o/2,y:n}}}function u(t,e,n){return t.x<e.x&&t.y<e.y?function(t,e,n){const r=t.joins.bottom,i=e.joins.left,s=o.gridSize,a=o.turnRadius;let h=0,c=e.row*o.rowHeight;return{tag:"g",attributes:{id:"connector-forward/"+n},children:[{tag:"path",attributes:{d:["M",r.x,r.y,"L",h=r.x,i.y-a,"A",a,a,0,0,0,r.x+a,i.y,"L",i.x,i.y].join(" "),fill:"none",stroke:o.strokeColor}},{tag:"path",attributes:{d:["M",i.x,i.y,"L",i.x-2*s,i.y-s,"L",i.x-2*s,i.y+s,"Z"].join(" ")},fill:o.strokeColor,stroke:o.strokeColor},d(n,1,h+o.gridSize,c-o.gridSize)]}}(t,e,n):function(t,e,n){const r=t.joins.top,i=e.joins.right,a=o.gridSize,c=o.turnRadius,l=o.columnWidth;let u=function(t,e){let n=(e.column>=t.column?e.column+1:t.column)+1;for(let o=e.row+1;o<t.row;o++)s[o].column>=n&&(n=s[o].column+1);const o=e.row+1,r=t.row-1;for(;;){if(!h[n]){h[n]=[{s:o,e:r}];break}if(h[n].every((t=>t.e==r||(t.s<o||t.s>r)&&(t.e<o||t.e>r)&&(o<t.s||o>t.e)))){h[n].push({s:o,e:r});break}n++}return n}(t,e),f=0,g=0,p=0,m=0;return{tag:"g",attributes:{id:"connector-backward/"+n},children:[{tag:"path",attributes:{d:["M",f=r.x,g=r.y,"A",c,c/2,0,0,1,f+=c,g-=c/2,"L",f=u*l,g,"A",c,c,0,0,0,f+=c,g-=c,"L",p=f,m=g=i.y+c,"A",c,c,0,0,0,f-=c,i.y,"L",i.x,i.y].join(" "),fill:"none",stroke:o.strokeColor}},{tag:"path",attributes:{d:["M",i.x,i.y,"L",i.x+2*a,i.y-a,"L",i.x+2*a,i.y+a,"z"].join(" "),fill:o.strokeColor,stroke:o.strokeColor}},d(n,1,p+o.gridSize,m)]}}(t,e,n)}function d(t="",e=1,n=0,r=0){const i=t.split(/\s/),s=[];let a="";return i.forEach((t=>{if(a=a?a+" "+t:t,a.length>=e){let t;s.push(t={tag:"tspan",attributes:{x:n,dy:o.fontSize},children:[a]}),o.textBoxLength<a.length&&(t.attributes["font-size"]=o.fontSize*o.textBoxLength/a.length),a=""}})),{tag:"text",attributes:{x:n,y:r-o.fontSize*s.length,"font-size":o.fontSize,"font-family":o.fontFace},children:s}}this.draw=function(){const n=new m("start",{type:"enter"},o).position(o.marginLeft,o.marginTop).render();n.joins=l(n),r.children.push(n),c(n,t.enterState,1,1);const a=h.length;return i.attributes.height=s.length*o.rowHeight,i.attributes.width=a*o.columnWidth+2*o.marginLeft,f(i,e,"http://www.w3.org/2000/svg")}}function C(){const t=document.createElement("canvas");return t.width=1300,t.height=1300,t}const b={buttons:[{title:"circle chart (png)",action:t=>{const n=C();return function(t,e){r={width:e.width,height:e.height};let n=e.getContext("2d");const o={x:r.width/2,y:r.height/2,offset:80},i={width:190,height:50},a=Object.keys(t.states).length;n.clearRect(0,0,n.canvas.width,n.canvas.height);let h={stateViews:{}},u=0;for(let e in t.states){let r={name:e,nextStates:t.states[e].connectors.map((t=>t.to)),incomingArrows:[],outgoingArrows:[]},d=l(u,a,o,i)+o.offset;d>o.y&&(d-=i.height);let f=l(u,a,o,i)+o.offset-i.height/2,g=c(u,a,o,i)+i.width/2;g<o.x?g+=i.width/2:g-=i.width/2,r.outgoingArrows.push({x:c(u,a,o,i)+i.width/2,y:d}),r.incomingArrows.push({x:g,y:f}),s(n,r,u,a,o,i),h.stateViews[r.name]=r,u++}Object.keys(h.stateViews).forEach((t=>{let e=Array(),o=h.stateViews[t];for(let t=0;t<o.nextStates.length;t++){let n=o.nextStates[t],r=h.stateViews[n];if(r){let t=r.incomingArrows[0];e.push({srcX:o.outgoingArrows[0].x,srcY:o.outgoingArrows[0].y,destX:t.x,destY:t.y})}}e.forEach((t=>function(t,e){e.beginPath(),e.moveTo(t.srcX,t.srcY),e.lineTo(t.destX,t.destY),e.stroke();const n=Math.atan2(t.destY-t.srcY,t.destX-t.srcX);e.beginPath(),e.moveTo(t.destX,t.destY),e.lineTo(t.destX-20*Math.cos(n-Math.PI/7),t.destY-20*Math.sin(n-Math.PI/9)),e.stroke(),e.beginPath(),e.moveTo(t.destX,t.destY),e.lineTo(t.destX-20*Math.cos(n+Math.PI/7),t.destY-20*Math.sin(n+Math.PI/9)),e.stroke()}(t,n)))}))}(e(t),n),n}},{title:"flow chart (png)",action:t=>{const n=C();return function(t,e){i={width:e.width,height:e.height};let n={bounds:{x:0,y:0},stateBounds:{width:190,height:150},stateColumns:Array()},o=[t.enterState],r=!0,s=0;for(n.stateColumns.push([{model:t.states[t.enterState],name:t.enterState}]);r;){let e=Array();r=!1;for(let i=0;i<n.stateColumns[n.stateColumns.length-1].length;i++){let s=n.stateColumns[n.stateColumns.length-1][i].model;for(let n=0;n<s?.connectors?.length;n++)if("end"!==s.connectors[n].to&!o.includes(s.connectors[n].to)){o.push(s.connectors[n].to),r=!0;let i={model:t.states[s.connectors[n].to],name:s.connectors[n].to};e.push(i)}}e.length>0&&(n.stateColumns.push(e),e.length>s&&(s=e.length))}Object.keys(t.states).forEach((e=>{o.includes(e)||n.stateColumns.push([{model:t.states[e],name:e}])})),n.bounds.x=n.stateBounds.width*(2*n.stateColumns.length+1),n.bounds.y=n.stateBounds.height*(2*s+1),e.width=n.bounds.x,e.height=n.bounds.y;const a=e.getContext("2d");i.width=e.width,i.height=e.height;let h={};a.fillStyle="#eeeeee",a.fillRect(0,0,n.bounds.x,n.bounds.y),a.stroke();for(let t=0;t<n.stateColumns.length;t++)for(let e=0;e<n.stateColumns[t].length;e++)u(n,t,e,a),h[n.stateColumns[t][e].name]={x:n.stateColumns[t][e].rectCoordinateX,y:n.stateColumns[t][e].rectCoordinateY,cellPositionX:t,cellPositionY:e,freeIncomingPosition:1};for(let t=0;t<n.stateColumns.length;t++){let e=0;for(let o=0;o<n.stateColumns[t].length;o++){let r=0;for(let i=0;i<n.stateColumns[t][o].model?.connectors?.length;i++){if(h[n.stateColumns[t][o].model.connectors[i].to]){let s=n.stateColumns[t][o].rectCoordinateX+n.stateBounds.width,c=n.stateColumns[t][o].rectCoordinateY+n.stateBounds.height/2,l=h[n.stateColumns[t][o].model.connectors[i].to].x,u=h[n.stateColumns[t][o].model.connectors[i].to].y+n.stateBounds.height/2;l<s&&(s-=n.stateBounds.width,l+=n.stateBounds.width),d({srcX:s,srcY:c+r,destX:l,destY:u+r-10*h[n.stateColumns[t][o].model.connectors[i].to].freeIncomingPosition,srcColNum:t,srcRowNum:o,destColNum:h[n.stateColumns[t][o].model.connectors[i].to].cellPositionX,connectorCentralOffsetX:e,connectorCentralOffsetY:r},n,a)}r+=5,e+=5,h[n.stateColumns[t][o].model.connectors[i].to]&&h[n.stateColumns[t][o].model.connectors[i].to].freeIncomingPosition++}}}}(e(t),n),n}},{title:"tree chart (svg)",action:t=>new y(e(t),document).draw()}]};var w=n(836),v=n.n(w);(function(t){var e=[function(t){return new(v())(t).setRegistry({"APP-ROOT":{prep:{tgn:"MAIN",as:"app-root",attr:{as:"app-root"},ch:[{tgn:"H1",attr:{style:"height:80px;width:100%;position:fixed;left:0; top:0;z-index: 10;min-width: 400px;padding-left: 40px;"},ch:["\n        Анализ Workflow"]},{tgn:"DIV",attr:{style:"margin-top:80px;"},ch:[{tgn:"TABLE",attr:{style:"width: 100%;"},ch:[{tgn:"TBODY",attr:{},ch:[{tgn:"TR",attr:{style:"vertical-align: top;"},ch:[{tgn:"TD",attr:{style:"height:300px;"},ch:[{tgn:"DIV",attr:{style:"width:100%;height:100%;",_ref:"source"},ch:[]}]},{tgn:"TD",attr:{style:"width:100px;height:300px;"},ch:[{tgn:"ARRAY-ITERATOR",attr:{_ref:"controls"},ch:[{tgn:"CONTROL-BUTTON",attr:{},ch:[]}]},{tgn:"DIV",attr:{style:"padding: 20px 5px 0 5px; font-size: 16px;;"},ch:["\n                        Вставь xml в поле слева и нажми на одну из кнопок\n                    "]}]},{tgn:"TD",attr:{class:"report",style:"width: 250px;height:300px;color:#FFFFFF;padding:0 30px;",_ref:"report"},ch:[{tgn:"DIV",attr:{},ch:["Всего состояний: 100"]}]}]}]}]},{tgn:"DIV",attr:{_ref:"chartView"},ch:[]}]}],script:function(t,e,n,o){const r=ace.edit(this.ref.source);r.setTheme("ace/theme/monokai"),r.session.setMode("ace/mode/xml"),this.ref.source.style.fontSize="14px",this.ref.source.style.fontFamily="'Courier New', Courier, monospace'",this.ref.controls.setData(t.buttons,{target:this.ref.chartView,editor:r})}}},"CONTROL-BUTTON":{prep:{tgn:"BUTTON",as:"control-button",attr:{as:"control-button"},ch:[],script:function(t,e,n,o){const r={canvas:"img-container",svg:"svg-container"},i=new DOMParser;this.onSetData=(t,n)=>{this.innerHTML=t.title,this.onclick=()=>{Array.prototype.slice.call(n.target.children).forEach((t=>{t.destroy()}));const o=n.editor.getValue();if(!o?.trim())return;const s=i.parseFromString(o,"text/xml"),a=t.action(s),h=e.create(r[a.tagName.toLowerCase()]);h.mount(n.target),h.setData(a)}}}}},"IMG-CONTAINER":{prep:{tgn:"DIV",as:"img-container",attr:{as:"img-container",style:"background-color: #FFFFFF;"},ch:[],script:function(t,e,n,o){this.onSetData=t=>{t.style.width="100%",this.appendChild(t)}}}},"SVG-CONTAINER":{prep:{tgn:"DIV",as:"svg-container",attr:{as:"svg-container",style:"background-color: #FFFFFF;"},ch:[],script:function(t,e,n,o){let r,i;this.onSetData=t=>{r=1*t.getAttribute("width"),i=1*t.getAttribute("height"),this.appendChild(t);let e=()=>s(t,this);window.addEventListener("resize",e),this.onDestroy=()=>{window.removeEventListener("resize",e)},s(t,this)};const s=(t,e)=>{let n=e.offsetWidth/r||1;Math.floor(e.offsetWidth-r),Math.floor(n*i-i),t.setAttribute("viewBox",[0,0,r,n<1?i/n:i].join(" ")),t.setAttribute("width",e.offsetWidth)}}}}})}(t)];return e[0]})(b).create("app-root").mount(document.body)})()})();