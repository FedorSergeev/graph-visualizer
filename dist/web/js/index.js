(()=>{"use strict";var t={836:t=>{function e(t){var n={},r=this;this.getRegistry=function(){var t={};for(var e in n)n[e].builtin||(t[e]=n[e]);return t},this.setRegistry=function(t){for(var e in t)n[e]=t[e];return r};var o={},i={};function s(t){if(t=t&&t.toUpperCase(),i[t])return i[t].evaluated?i[t].evaluated:void 0}this.putModule=function(t,e,n){var r={html:o,js:i};t=t.toUpperCase(),r[n]&&(r[n][t]=e)};var a=e.document||window.document,c={};this.getShared=function(){return c},this.findLocalPrep=function(t){var e=(t+"").toUpperCase();return n[e]&&n[e].prep?n[e].prep:void 0},this.findPrep=function(t){var e;if(e=this.findLocalPrep(t))return e;var n=(t+"").toUpperCase().split(":");return n.length>1&&o[n[0]]?o[n[0]].findPrep(n.slice(1).join(":")):void 0};var l=function(e,n){var o=r.findLocalPrep(n);o&&(o.superc&&l(e,o.superc),o.script&&(e.__=o.script,e.__(t,r,a,s),e.onCreate()))};function h(t,e){if(e&&t&&t.setAttribute)for(var n in e)t.setAttribute(n,e[n])}function u(t){var e={};e.tgn=t.getAttribute("tagname")||t.tagName,e.as=t.getAttribute("as"),e.attr=function(t){for(var e={},n=0;n<t.length;n++)e[t[n].name.toLowerCase()]=t[n].value;return e}(t.attributes),e.attr.ref&&(e.attr._ref=e.attr.ref,delete e.attr.ref),e.ch=[],e.superc=t.getAttribute("super")||void 0;for(var n=t.childNodes,o=0;o<n.length;o++){var i=n[o],s=i.textContent||i.innerHTML||i.nodeValue||"";if(!(i.nodeType>3))if(i.tagName){var a=i.tagName.toUpperCase();if("CONSTRUCTOR"===a||"SCRIPT"===a){var c=(r.src?"/*"+t.outerHTML.replace(s,"see script below").replace("*/","*\\/")+"*/\n":"")+s+(r.src?"\n//# sourceURL=W3View:///"+r.src+"<"+e.as+">":"");e.script=new Function("appContext,factory,document,require",c)}else{var l=u(i);delete l.script,delete l.as,e.ch.push(l)}}else s.trim()&&e.ch.push(s)}return e}this.parse=function(t){var e=a.createElement("div");e.innerHTML=t;var n=e.children;return n.length?(this.register(n),this):t},this.register=function(t){for(var e=0;e<t.length;e++)this.registerElement(t[e])},this.registerElement=function(t){if("IMPORT"===t.tagName.toUpperCase()&&t.getAttribute("type")){var e=t.getAttribute("type").toLowerCase();"html"!==e&&"js"!==e||(this.imports=this.imports||[],this.imports.push({type:e,src:t.getAttribute("src"),name:t.getAttribute("as")}))}else{var r=(t.getAttribute("as")||"").toUpperCase();if(r){if(n[r])throw new Error(r+" - is already registered component");var o=u(t);n[r]={},n[r].prep=o}}},this.create=function(t,n,i,s){var c;n=n||{},i=i||[];var u=this.findLocalPrep(t);if(u)if(this.findPrep(u.tgn)){var d=e.mix(e.mix({},u.attr),n.usetag?{usetag:n.usetag}:{});c=this.create(u.tgn,d,u.ch)}else c=function(t,e){var n=a.createElement(t);if(n.as=e.as,n.ref={content:n},h(n,e.attr),e.ch&&e.ch.length)for(var o=0;o<e.ch.length;o++)if(e.ch[o].tgn){var i=r.create(e.ch[o].tgn,e.ch[o].attr,e.ch[o].ch,n),s=i.getAttribute("_ref");s&&(n.ref[s]=i),n.appendChild(i),i.onMount&&i.onMount()}else n.appendChild(a.createTextNode(e.ch[o]));return n}(n.usetag||u.tgn,u);else{var f=t.toUpperCase().split(":");f.length>1&&o[f[0]]?(c=o[f[0]].create(f.slice(1).join(":"),n)).fullTgn=t:c=a.createElement(t),c.ref=c.ref||{content:c}}if(s||(s=c),h(c,n),i&&i.length)for(var g=0;g<i.length;g++)if(i[g].tgn){var p=this.create(i[g].tgn,i[g].attr,i[g].ch,s),m=p.getAttribute("_ref");m&&(s.ref=s.ref||{},s.ref[m]=p),p.mount?p.mount(c):c.ref.content.appendChild(p)}else c.ref.content.appendChild(a.createTextNode(i[g]));var x=e.mixin;return u&&(e.mix(c,x,!0),l(c,t)),c.destroy=x.destroy,c},this.byExample=function(t){if(!t.as)throw new Error("Sample should be registered component");for(var e={},n=0;n<t.attributes.length;n++){var r=t.attributes[n];t[r.name]&&"function"==typeof t[r.name]||(e[r.name]=r.value)}return this.create(t.fullTgn||t.as,e)},n["ARRAY-ITERATOR"]={prep:{tgn:"DIV",as:"ARRAY-ITERATOR",attr:{as:"ARRAY-ITERATOR"}}},n["ARRAY-ITERATOR"].builtin=!0,this.findLocalPrep("ARRAY-ITERATOR").script=function(t,e){for(var n=[];this.children.length>0;)n.push(this.removeChild(this.children[0]));this.onSetData=function(t,r){t||(t=[]),Array.isArray(t)||(t=[t]);for(var o=0;o<t.length||o<this.children.length;o++)if(this.children[o]&&t.length<=o)this.children[o].destroy(),o--;else{var i=t[o],s=this.children[o];s||(s=e.byExample(n[o%n.length])).mount(this),s.setData(i,r,o)}}}}String.prototype.trim=String.prototype.trim||function(){return this},e.mix=function(t,e,n){for(var r in t=t||{},e=e||{})t[r]=(n?t[r]:null)||e[r];return t},e.mixin={},e.mixin.start=function(){this.onStart&&this.onStart();for(var t=0;this.children&&t<this.children.length;t++){var n=this.children[t];n.start=n.start||e.mixin.start,n.start()}},e.mixin.stop=function(){this.onStop&&this.onStop();for(var t=0;this.children&&t<this.children.length;t++){var n=this.children[t];n.stop=n.stop||e.mixin.stop,n.stop()}},e.mixin.onStart=function(){},e.mixin.onStop=function(){},e.mixin.mount=function(t,e){t=t.ref&&t.ref.content?t.ref.content:t,this.unmount(),void 0===e||t.childNodes.length<=e?t.appendChild(this):t.insertBefore(this,t.childNodes[e<0?0:e]),this.onMount()},e.mixin.unmount=function(){this.parentNode&&(this.onUnmount(),this.parentNode.removeChild(this))},e.mixin.setData=function(t,e,n){this.onSetData(t,e,n)},e.mixin.destroy=function(){for(this.unmount?this.unmount():this.parentNode.removeChild(this),this.onDestroy&&this.onDestroy(),this.onStop&&this.onStop();this.children.length;)this.children[0].destroy||(this.children[0].destroy=e.mixin.destroy),this.children[0].destroy()},e.mixin.onSetData=function(t,e){},e.mixin.onMount=function(){},e.mixin.onUnmount=function(){},e.mixin.onCreate=function(){},e.mixin.onDestroy=function(){},t.exports=e}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{const t="end";function e(e){const n={apiVerion:"1.0",enterState:e.documentElement.getAttribute("start-state"),terminator:t,description:"",properties:{},states:{}},o=e.getElementsByTagName("state");for(let t=0;t<o.length;t++){let e=o[t],i={type:"decision",connectors:[],external:{}};r(e,i),n.states[e.getAttribute("name")]={type:i.type,description:e.getAttribute("title"),properties:{},connectors:i.connectors},Object.keys(i.external).forEach((t=>{n.states[t]?i.external[t].connectors.forEach((e=>{n.states[t].connectors.push(e)})):n.states[t]=i.external[t]}))}return n}function r(e,n){const r={},o=[];for(let t=0;t<e.childNodes.length;t++){let r=e.childNodes.item(t);if("event"!==r.tagName)if("state-transition"!==r.tagName){if("flow-transition"===r.tagName){n.external=n.external||{};let t=r.getAttribute("subflow");n.external["#"+t]={type:"external",description:"",properties:{},connectors:[{name:"#return",to:e.getAttribute("name")}]},i({name:r.getAttribute("name"),to:"#"+t})}}else i({name:r.getAttribute("name"),to:r.getAttribute("to")});else n.type="interactive"}function i(t){r[t.to]?r[t.to].name+=", "+t.name:(r[t.to]=t,o.push(t))}o.length<=1&&"decision"===n.type&&(n.type="process"),!o.length&&i({name:"#link?",to:t}),o.forEach((t=>n.connectors.push(t)))}function o(t,e={}){const n={totalStates:0,decision:0,external:0,process:0,interactive:0,unused:0,totalJoins:0,badTargets:0,terminators:0,terminatorStates:0},r={},o=[];return function e(o){const i=t.states[o];i?(r[o]=!0,n[i.type]++,i.connectors?.forEach((o=>{"#link?"===o.name?n.terminatorStates++:n.totalJoins++,o.to===t.terminator?n.terminators++:r[o.to]||e(o.to)}))):n.badTargets++}(t.enterState),Object.keys(t.states||{}).forEach((t=>{r[t]||o.push(t),n.totalStates++})),{states:[{name:"count",value:n.totalStates},{name:"unused",value:o.length},{name:"unusedList",value:o.length?"["+o.join(", ")+"]":""},{name:"decision",value:n.decision},{name:"process",value:n.process},{name:"external",value:n.external},{name:"interactive",value:n.interactive}],joins:[{name:"total",value:n.totalJoins},{name:"badTargets",value:n.badTargets},{name:"terminatorStates",value:n.terminatorStates},{name:"terminators",value:n.terminators}]}}let i,s;function a(t,e,n,r,o,i){t.beginPath(),t.lineWidth=2,t.strokeStyle="#003300",t.rect(c(n,r,o,i),l(n,r,o,i),i.width,i.height),t.stroke(),function(t,e,n){t.beginPath(),t.arc(e,n,4,0,2*Math.PI,!1),t.fillStyle="#ffffff",t.fill(),t.strokeStyle="#003300",t.stroke()}(t,e.outgoingArrows[0].x,e.outgoingArrows[0].y),function(t,e,n){t.beginPath(),t.arc(e,n,4,0,2*Math.PI,!1),t.fillStyle="#000000",t.fill(),t.strokeStyle="#003300",t.stroke()}(t,e.incomingArrows[0].x,e.incomingArrows[0].y);let s=h(n,r,o,i),a=u(n,r,o,i)+45;t.font="14px Arial",t.fillStyle="#000000",t.fillText(e.name,s,a)}function c(t,e,n,r){let o=2*Math.PI/e*(t+1),s=i.height/2-n.offset;return n.x+s*Math.cos(o)-r.width/2}function l(t,e,n,r){let o=2*Math.PI/e*(t+1),s=i.height/2-n.offset;return n.x+s*Math.sin(o)-r.height/2}function h(t,e,n,r){return c(t,e,n,r)+5}function u(t,e,n,r){return l(t,e,n,r)-25}function d(t,e,n,r){t.stateColumns[e][n].rectCoordinateX=t.stateBounds.width+t.stateBounds.width*e*2,t.stateColumns[e][n].rectCoordinateY=(t.bounds.y-(2*t.stateColumns[e].length-1)*t.stateBounds.height)/2+t.stateBounds.height*n*2,t.stateColumns[e][n].cellPositionX=e,t.stateColumns[e][n].cellPositionY=n,r.beginPath(),r.lineWidth=2,r.strokeStyle="#000000",r.rect(t.stateColumns[e][n].rectCoordinateX,t.stateColumns[e][n].rectCoordinateY,t.stateBounds.width,t.stateBounds.height),r.stroke(),r.font="14px Arial",r.fillStyle="#000000",r.fillText(t.stateColumns[e][n].name,t.stateColumns[e][n].rectCoordinateX+10,t.stateColumns[e][n].rectCoordinateY+15)}function f(t,e,n){t.srcColNum>t.destColNum?(t.srcY-=e.stateBounds.height/3.5,t.destY-=e.stateBounds.height/3.5):t.srcColNum<t.destColNum&&(t.srcY+=e.stateBounds.height/3.5,t.destY+=e.stateBounds.height/3.5);let r=t.srcColNum<t.destColNum?t.srcX+t.connectorCentralOffsetX+.65*e.stateBounds.width:t.srcX+t.connectorCentralOffsetX-.65*e.stateBounds.width;n.beginPath(),n.moveTo(t.srcX,t.srcY),n.lineTo(r,t.srcY),n.stroke(),n.beginPath(),n.moveTo(r,t.srcY),n.lineTo(r,t.destY),n.stroke(),n.beginPath(),n.moveTo(r,t.destY),n.lineTo(t.destX,t.destY),n.stroke();const o=t.srcColNum<t.destColNum?0:Math.PI;n.beginPath(),n.moveTo(t.destX,t.destY),n.lineTo(t.destX-20*Math.cos(o-Math.PI/7),t.destY-20*Math.sin(o-Math.PI/9)),n.stroke(),n.beginPath(),n.moveTo(t.destX,t.destY),n.lineTo(t.destX-20*Math.cos(o+Math.PI/7),t.destY-20*Math.sin(o+Math.PI/9)),n.stroke()}function g(t,e,n){if(!t)return e.createTextNode("");if("object"!=typeof t)return e.createTextNode(t);const r=n&&e.createElementNS(n,t.tag)||e.createElement(t.tag);return Object.keys(t.attributes||{}).forEach((e=>{r.setAttribute(e,t.attributes[e])})),t.children?.forEach((t=>{r.appendChild(g(t,e,n))})),r}const p={gridSize:5,shapeHeight:40,shapeWidth:80,strokeColor:"#000000",bgColor:"#CCCCFF",bgColorInteractive:"#CCFFFF",textColor:"#000000",fontFace:"sans-serif",fontSize:10},m={};function x(t,e,n=p){const r={};Object.keys(p).forEach((t=>{r[t]=n[t]+""&&n[t]||p[t]}));const o=[0,0];this.getShapes=()=>m,this.position=(t,e)=>(o[0]=t,o[1]=e,this),this.render=()=>{if(!e)return;const n=m[e.type](t,e,r);return n.attributes.id="state-"+e.type+"/"+t,n.attributes.transform="translate("+o.join(" ")+")",n.x=o[0],n.y=o[1],n}}m.process=m.interactive=(t,e,n=p)=>{const r=n.shapeWidth,o=n.shapeHeight;return{width:r,height:o,tag:"g",attributes:{transform:"translate(0 0)"},children:[{tag:"rect",attributes:{x:0,y:0,width:r,height:o,rx:.5*n.gridSize,ry:.5*n.gridSize,fill:"interactive"===e.type?n.bgColorInteractive:n.bgColor,stroke:n.strokeColor}},{tag:"text",attributes:{x:n.gridSize,y:3*n.gridSize,fill:n.textColor,"font-size":n.fontSize,"font-family":n.fontFace},children:[t]},{tag:"text",attributes:{x:n.gridSize,y:5*n.gridSize,"font-size":n.fontSize,"font-family":n.fontFace},children:[e.description&&"("+e.description+")"]}]}},m.decision=(t,e,n=p)=>{const r=n.shapeWidth,o=n.shapeHeight;return{width:16*n.gridSize,height:8*n.gridSize,tag:"g",attributes:{transform:"translate(0 0)"},children:[{tag:"path",attributes:{d:["M",0,o/2,"L",r/2,0,"L",r,o/2,"L",r/2,o,"z"].join(" "),fill:n.bgColor,stroke:n.strokeColor}},{tag:"text",attributes:{x:4*n.gridSize,y:3*n.gridSize,fill:n.textColor,"font-size":n.fontSize,"font-family":n.fontFace},children:[t]},{tag:"text",attributes:{x:4*n.gridSize,y:5*n.gridSize,"font-size":n.fontSize,"font-family":n.fontFace},children:[e.description&&"("+e.description+")"]}]}},m.external=(t,e,n=p)=>{const r=n.shapeWidth,o=n.shapeHeight;return{width:r,height:o,tag:"g",attributes:{transform:"translate(0 0)"},children:[{tag:"path",attributes:{d:["M",0,0,"L",r-2*n.gridSize,0,"L",r,o/2,"L",r-2*n.gridSize,o,"L",0,o,"z"].join(" "),fill:n.bgColor,stroke:n.strokeColor}},{tag:"text",attributes:{x:n.gridSize,y:3*n.gridSize,fill:n.textColor,"font-size":n.fontSize,"font-family":n.fontFace},children:[t]},{tag:"text",attributes:{x:n.gridSize,y:5*n.gridSize,"font-size":n.fontSize,"font-family":n.fontFace},children:[e.description&&"("+e.description+")"]}]}},m.enter=m.end=(t,e,n=p)=>{const r=12*n.gridSize,o=3*n.gridSize,i=o/2;return{width:r,height:o,tag:"g",attributes:{transform:"translate(0 0)"},children:[{tag:"path",attributes:{d:["M",i,0,"L",r-i,0,"A",i,i,0,0,1,r-i,o,"L",i,o,"A",i,i,0,0,1,i,0].join(" "),fill:"white",stroke:n.strokeColor}},{tag:"text",attributes:{x:n.gridSize,y:2*n.gridSize,fill:n.textColor,"font-size":n.fontSize,"font-family":n.fontFace},children:[t]}]}};const v={rowHeight:60,columnWidth:80,turnRadius:15,marginLeft:10,marginTop:10,textBoxLength:15,gridSize:5,shapeHeight:40,shapeWidth:80,strokeColor:"#000000",bgColor:"#CCCCFF",bgColorInteractive:"#CCFFFF",textColor:"#000000",fontFace:"sans-serif",fontSize:10};function w(t,e,n=v){const r={};Object.keys(v).forEach((t=>{r[t]=n[t]+""&&n[t]||v[t]}));const o={tag:"g",attributes:{transform:"translate(0 0)"},children:[]},i={tag:"svg",attributes:{version:"1.1",xmlns:"http://www.w3.org/2000/svg"},children:[o]},s=[],a={};let c=[];function l(e,n,i,d,f){let g=t.states[n],p=!1;if(!g){if(n!==t.terminator)return void console.warn("State ["+n+"] not found");g={type:"end"},p=!0}const m=new x(n,g,r).position(d*r.columnWidth,i*r.rowHeight).render();m.joins=h(m),!p&&(a[n]=m),s[i]=m,c[d]||(c[d]=[]),m.column=d,m.row=i,o.children.push(m),o.children.push(u(e,m,f)),g.connectors?.forEach((t=>{let e=t.to;a[e]?o.children.push(u(m,a[e],t.name)):l(m,e,s.length,d+1,t.name)}))}function h(t){const e=t.x,n=t.y,r=t.width,o=t.height;return{left:{x:e,y:n+o/2},bottom:{x:e+r/2,y:n+o},right:{x:e+r,y:n+o/2},top:{x:e+r/2,y:n}}}function u(t,e,n){return t.x<e.x&&t.y<e.y?function(t,e,n){const o=t.joins.bottom,i=e.joins.left,s=r.gridSize,a=r.turnRadius;let c=0,l=e.row*r.rowHeight;return{tag:"g",attributes:{id:"connector-forward/"+n},children:[{tag:"path",attributes:{d:["M",o.x,o.y,"L",c=o.x,i.y-a,"A",a,a,0,0,0,o.x+a,i.y,"L",i.x,i.y].join(" "),fill:"none",stroke:r.strokeColor}},{tag:"path",attributes:{d:["M",i.x,i.y,"L",i.x-2*s,i.y-s,"L",i.x-2*s,i.y+s,"Z"].join(" ")},fill:r.strokeColor,stroke:r.strokeColor},d(n,1,c+r.gridSize,l-r.gridSize)]}}(t,e,n):function(t,e,n){const o=t.joins.top,i=e.joins.right,a=r.gridSize,l=r.turnRadius,h=r.columnWidth;let u=function(t,e){let n=(e.column>=t.column?e.column+1:t.column)+1;for(let r=e.row;r<t.row;r++)s[r].column>=n&&(n=s[r].column+1);const r=e.row,o=t.row;for(;;){if(!c[n]){c[n]=[{s:r,e:o}];break}if(c[n].every((t=>t.e==o||r>=t.e))){c[n].push({s:r,e:o});break}n++}return n}(t,e),f=0,g=0,p=0,m=0;return{tag:"g",attributes:{id:"connector-backward/"+n},children:[{tag:"path",attributes:{d:["M",f=o.x,g=o.y,"A",l,l/2,0,0,1,f+=l,g-=l/2,"L",f=u*h,g,"A",l,l,0,0,0,f+=l,g-=l,"L",p=f,m=g=i.y+l,"A",l,l,0,0,0,f-=l,i.y,"L",i.x,i.y].join(" "),fill:"none",stroke:r.strokeColor}},{tag:"path",attributes:{d:["M",i.x,i.y,"L",i.x+2*a,i.y-a,"L",i.x+2*a,i.y+a,"z"].join(" "),fill:r.strokeColor,stroke:r.strokeColor}},d(n,1,p+r.gridSize,m)]}}(t,e,n)}function d(t="",e=1,n=0,o=0){const i=t.split(/\s/),s=[];let a="";return i.forEach((t=>{if(a=a?a+" "+t:t,a.length>=e){let t;s.push(t={tag:"tspan",attributes:{x:n,dy:r.fontSize},children:[a]}),r.textBoxLength<a.length&&(t.attributes["font-size"]=r.fontSize*r.textBoxLength/a.length),a=""}})),{tag:"text",attributes:{x:n,y:o-r.fontSize*s.length,"font-size":r.fontSize,"font-family":r.fontFace},children:s}}this.draw=function(){const n=new x("start",{type:"enter"},r).position(r.marginLeft,r.marginTop).render();n.joins=h(n),o.children.push(n),l(n,t.enterState,1,1);const a=c.length;return i.attributes.height=s.length*r.rowHeight,i.attributes.width=a*r.columnWidth+2*r.marginLeft,g(i,e,"http://www.w3.org/2000/svg")}}function y(){const t=document.createElement("canvas");return t.width=1300,t.height=1300,t}const b={target:document.body,buttons:[{title:"circle chart (png)",action:t=>{const n=y(),r=e(t);return function(t,e){i={width:e.width,height:e.height};let n=e.getContext("2d");const r={x:i.width/2,y:i.height/2,offset:80},o={width:190,height:50},s=Object.keys(t.states).length;n.clearRect(0,0,n.canvas.width,n.canvas.height);let c={stateViews:{}},l=0;for(let e in t.states){let i={name:e,nextStates:t.states[e].connectors.map((t=>t.to)),incomingArrows:[],outgoingArrows:[]},d=u(l,s,r,o)+r.offset;d>r.y&&(d-=o.height);let f=u(l,s,r,o)+r.offset-o.height/2,g=h(l,s,r,o)+o.width/2;g<r.x?g+=o.width/2:g-=o.width/2,i.outgoingArrows.push({x:h(l,s,r,o)+o.width/2,y:d}),i.incomingArrows.push({x:g,y:f}),a(n,i,l,s,r,o),c.stateViews[i.name]=i,l++}Object.keys(c.stateViews).forEach((t=>{let e=Array(),r=c.stateViews[t];for(let t=0;t<r.nextStates.length;t++){let n=r.nextStates[t],o=c.stateViews[n];if(o){let t=o.incomingArrows[0];e.push({srcX:r.outgoingArrows[0].x,srcY:r.outgoingArrows[0].y,destX:t.x,destY:t.y})}}e.forEach((t=>function(t,e){e.beginPath(),e.moveTo(t.srcX,t.srcY),e.lineTo(t.destX,t.destY),e.stroke();const n=Math.atan2(t.destY-t.srcY,t.destX-t.srcX);e.beginPath(),e.moveTo(t.destX,t.destY),e.lineTo(t.destX-20*Math.cos(n-Math.PI/7),t.destY-20*Math.sin(n-Math.PI/9)),e.stroke(),e.beginPath(),e.moveTo(t.destX,t.destY),e.lineTo(t.destX-20*Math.cos(n+Math.PI/7),t.destY-20*Math.sin(n+Math.PI/9)),e.stroke()}(t,n)))}))}(r,n),n.report=o(r),n}},{title:"flow chart (png)",action:t=>{const n=y(),r=e(t);return function(t,e){s={width:e.width,height:e.height};let n={bounds:{x:0,y:0},stateBounds:{width:190,height:150},stateColumns:Array()},r=[t.enterState],o=!0,i=0;for(n.stateColumns.push([{model:t.states[t.enterState],name:t.enterState}]);o;){let e=Array();o=!1;for(let i=0;i<n.stateColumns[n.stateColumns.length-1].length;i++){let s=n.stateColumns[n.stateColumns.length-1][i].model;for(let n=0;n<s?.connectors?.length;n++)if("end"!==s.connectors[n].to&!r.includes(s.connectors[n].to)){r.push(s.connectors[n].to),o=!0;let i={model:t.states[s.connectors[n].to],name:s.connectors[n].to};e.push(i)}}e.length>0&&(n.stateColumns.push(e),e.length>i&&(i=e.length))}Object.keys(t.states).forEach((e=>{r.includes(e)||n.stateColumns.push([{model:t.states[e],name:e}])})),n.bounds.x=n.stateBounds.width*(2*n.stateColumns.length+1),n.bounds.y=n.stateBounds.height*(2*i+1),e.width=n.bounds.x,e.height=n.bounds.y;const a=e.getContext("2d");s.width=e.width,s.height=e.height;let c={};a.fillStyle="#eeeeee",a.fillRect(0,0,n.bounds.x,n.bounds.y),a.stroke();for(let t=0;t<n.stateColumns.length;t++)for(let e=0;e<n.stateColumns[t].length;e++)d(n,t,e,a),c[n.stateColumns[t][e].name]={x:n.stateColumns[t][e].rectCoordinateX,y:n.stateColumns[t][e].rectCoordinateY,cellPositionX:t,cellPositionY:e,freeIncomingPosition:1};for(let t=0;t<n.stateColumns.length;t++){let e=0;for(let r=0;r<n.stateColumns[t].length;r++){let o=0;for(let i=0;i<n.stateColumns[t][r].model?.connectors?.length;i++){if(c[n.stateColumns[t][r].model.connectors[i].to]){let s=n.stateColumns[t][r].rectCoordinateX+n.stateBounds.width,l=n.stateColumns[t][r].rectCoordinateY+n.stateBounds.height/2,h=c[n.stateColumns[t][r].model.connectors[i].to].x,u=c[n.stateColumns[t][r].model.connectors[i].to].y+n.stateBounds.height/2;h<s&&(s-=n.stateBounds.width,h+=n.stateBounds.width),f({srcX:s,srcY:l+o,destX:h,destY:u+o-10*c[n.stateColumns[t][r].model.connectors[i].to].freeIncomingPosition,srcColNum:t,srcRowNum:r,destColNum:c[n.stateColumns[t][r].model.connectors[i].to].cellPositionX,connectorCentralOffsetX:e,connectorCentralOffsetY:o},n,a)}o+=5,e+=5,c[n.stateColumns[t][r].model.connectors[i].to]&&c[n.stateColumns[t][r].model.connectors[i].to].freeIncomingPosition++}}}}(r,n),n.report=o(r),n}},{title:"tree chart (svg)",action:t=>{const n=e(t),r=new w(n,document).draw();return r.report=o(n),r}}]};var C=n(836),S=n.n(C);(function(t){var e=[function(t){return new(S())(t).setRegistry({"APP-ROOT":{prep:{tgn:"MAIN",as:"app-root",attr:{as:"app-root"},ch:[{tgn:"H1",attr:{style:"height:80px;width:100%;position:fixed;left:0; top:0;z-index: 10;min-width: 400px;padding-left: 40px;"},ch:["\n        Анализ Workflow"]},{tgn:"DIV",attr:{style:"margin-top:80px;"},ch:[{tgn:"TABLE",attr:{style:"width: 100%;height: 300px;"},ch:[{tgn:"TBODY",attr:{},ch:[{tgn:"TR",attr:{style:"vertical-align: top;"},ch:[{tgn:"TD",attr:{style:"height:100%;"},ch:[{tgn:"DIV",attr:{style:"width:100%;height:100%;",_ref:"source"},ch:[]}]},{tgn:"TD",attr:{style:"width:100px;"},ch:[{tgn:"ARRAY-ITERATOR",attr:{_ref:"controls"},ch:[{tgn:"CONTROL-BUTTON",attr:{},ch:[]}]},{tgn:"DIV",attr:{style:"padding: 20px 5px 0 5px; font-size: 16px;;"},ch:["\n                        Вставь xml в поле слева и нажми на одну из кнопок\n                    "]}]},{tgn:"TD",attr:{class:"report"},ch:[{tgn:"REPORT-BOX",attr:{class:"report",_ref:"report"},ch:[]}]}]}]}]},{tgn:"DIV",attr:{_ref:"chartView"},ch:[]}]}],script:function(t,e,n,r){const o=ace.edit(this.ref.source);o.setTheme("ace/theme/monokai"),o.session.setMode("ace/mode/xml"),this.ref.source.style.fontSize="14px",this.ref.source.style.fontFamily="'Courier New', Courier, monospace'",t.appRoot=this,this.onMount=()=>n.body.style.overflowY="scroll",this.onUnmount=()=>n.body.style.overflowY="auto",this.ref.controls.setData(t.buttons,{target:this.ref.chartView,reportTarget:this.ref.report,editor:o})}}},"CONTROL-BUTTON":{prep:{tgn:"BUTTON",as:"control-button",attr:{as:"control-button"},ch:[],script:function(t,e,n,r){const o={canvas:"canvas-container",svg:"svg-container"},i=new DOMParser;this.onSetData=(t,n)=>{this.innerText=t.title,this.onclick=()=>{Array.prototype.slice.call(n.target.children).forEach((t=>{t.destroy()})),n.reportTarget.setData();const r=n.editor.getValue();if(!r?.trim())return;const s=t.action(i.parseFromString(r,"text/xml")),a=e.create(o[s.tagName.toLowerCase()]);a.mount(n.target),n.reportTarget.setData(s.report),a.setData(s)}}}}},"CANVAS-CONTAINER":{prep:{tgn:"DIV",as:"canvas-container",attr:{as:"canvas-container",style:"background-color: #FFFFFF;"},ch:[{tgn:"CONTAINER-CONTROL",attr:{_ref:"controls"},ch:[]}],script:function(t,e,n,r){this.onSetData=t=>{t.style.width="100%",this.appendChild(t),this.ref.controls.setData(t,{download:function(){const e=n.createElement("a");e.href=t.toDataURL("image/png"),e.download="schema.png",e.click()},container:"expand-screen:img-box"})}}}},"SVG-CONTAINER":{prep:{tgn:"DIV",as:"svg-container",attr:{as:"svg-container",style:"background-color: #FFFFFF;"},ch:[{tgn:"CONTAINER-CONTROL",attr:{_ref:"controls"},ch:[]}],script:function(t,e,n,r){function o(t,e,n,r){let o=e.offsetWidth/n||1;t.setAttribute("viewBox",[0,0,n,o<1?r/o:r].join(" ")),t.setAttribute("width","100%")}this.onSetData=t=>{let e=1*t.getAttribute("width"),r=1*t.getAttribute("height");const i=t.cloneNode(!0);this.appendChild(i);let s=()=>o(i,this,e,r);window.addEventListener("resize",s),this.onDestroy=()=>{window.removeEventListener("resize",s)},this.ref.controls.setData(t.cloneNode(!0),{download:function(){const e=n.createElement("a");e.href=function(t){const e=(new TextEncoder).encode((new XMLSerializer).serializeToString(t));return"data:text/xml;base64,"+btoa(String.fromCodePoint(...e))}(t),e.download="schema.svg",e.click()},container:"expand-screen:svg-box"}),o(i,this,e,r)}}}},"CONTAINER-CONTROL":{prep:{tgn:"DIV",as:"container-control",attr:{as:"container-control",style:"position: relative;"},ch:[{tgn:"DIV",attr:{class:"container-control-position"},ch:[{tgn:"BUTTON",attr:{class:"container-control",title:"скачать",_ref:"download"},ch:["v"]},{tgn:"BUTTON",attr:{class:"container-control",title:"развернуть",_ref:"expand"},ch:["+"]}]}],script:function(t,e,n,r){this.onSetData=(n,r)=>{this.ref.expand.onclick=()=>{const o=e.create(r.container);o.mount(t.target),o.setData(n),t.appRoot.unmount()},this.ref.download.onclick=r.download}}}},"REPORT-BOX":{prep:{tgn:"DIV",as:"report-box",attr:{as:"report-box"},ch:[{tgn:"DIV",attr:{_ref:"box"},ch:[{tgn:"H3",attr:{style:"margin:0 0 10px;"},ch:["Отчёт"]},{tgn:"H4",attr:{},ch:["Состояния"]},{tgn:"ARRAY-ITERATOR",attr:{usetag:"div",_ref:"states"},ch:[{tgn:"REPORT-ROW",attr:{usetag:"div"},ch:[]}]},{tgn:"H4",attr:{},ch:["Переходы"]},{tgn:"ARRAY-ITERATOR",attr:{usetag:"div",_ref:"joins"},ch:[{tgn:"REPORT-ROW",attr:{usetag:"div"},ch:[]}]}]}],script:function(t,e,n,r){const o={count:"Количество общее",decision:"Разветвителей",process:"Процессов",interactive:"Интерактивных",external:"Внешних вызовов",unused:"Количество не достижимых",unusedList:"Недостижимы"},i={total:"Количество общее",badTargets:"Выходов в отсутствующие состояния",terminatorStates:"Состояний без переходов",terminators:"Выходов из процесса"};this.removeChild(this.ref.box),this.onSetData=t=>{if(!t&&this.ref.box.parentElement===this)return void this.removeChild(this.ref.box);if(!t)return;this.appendChild(this.ref.box);const e=t?.states?.filter((t=>!!t?.value));this.ref.states.setData(e,o);const n=t?.joins?.filter((t=>!!t?.value));this.ref.joins.setData(n,i)}}}},"REPORT-ROW":{prep:{tgn:"DIV",as:"report-row",attr:{as:"report-row"},ch:[{tgn:"span",attr:{tagname:"span",_ref:"title"},ch:[]},{tgn:"span",attr:{tagname:"span",style:"padding-left:10px;font-weight: bold;",_ref:"value"},ch:[]}],script:function(t,e,n,r){this.onSetData=(t,e)=>{this.ref.title.innerText=(e[t?.name]||t?.name)+":",this.ref.value.innerText=t?.value}}}}})}(t),function(t){return new(S())(t).setRegistry({"SCREEN-CONTROL":{prep:{tgn:"DIV",as:"screen-control",attr:{as:"screen-control",style:"position: relative;"},ch:[{tgn:"DIV",attr:{class:"container-control-position",style:"z-index: 100;"},ch:[{tgn:"DIV",attr:{style:"color:black;display: inline-block;margin-right: 10px;font-size: 20px;"},ch:[{tgn:"INPUT",attr:{type:"text",style:"color:inherit;width:50px;text-align:right;font-size: 20px;",_ref:"scale"},ch:[]},{tgn:"SPAN",attr:{style:"color:inherit;"},ch:[" %"]}]},{tgn:"BUTTON",attr:{class:"container-control",title:"увеличить",_ref:"plus"},ch:["+"]},{tgn:"BUTTON",attr:{class:"container-control",title:"к размеру окна",_ref:"zero"},ch:["[]"]},{tgn:"BUTTON",attr:{class:"container-control",title:"уменьшить",_ref:"minus"},ch:["−"]},{tgn:"BUTTON",attr:{class:"container-control",style:"margin-left: 10px;",title:"закрыть",_ref:"close"},ch:["x"]}]}],script:function(t,e,n,r){this.onSetData=({setScale:t,setTranslate:e,reset:n})=>{this.ref.scale.value=100*n(),this.ref.scale.focus(),this.ref.plus.onclick=()=>{this.ref.scale.value=Number.parseInt(this.ref.scale.value)+10,r()},this.ref.minus.onclick=()=>{this.ref.scale.value=Number.parseInt(this.ref.scale.value)-10,r()},this.ref.zero.onclick=()=>{this.ref.scale.value=100*n()};const r=this.ref.scale.onchange=()=>{let e=Number.parseInt(this.ref.scale.value);if(e<10&&(e=this.ref.scale.value=10),isNaN(e)||!e)return this.ref.scale.value=100,void t(1);t(e/100)};o(r,e)},this.ref.scale.onkeydown=t=>{"ArrowDown"===t.key&&this.ref.minus.onclick(),"ArrowUp"===t.key&&this.ref.plus.onclick()},this.ref.minus.onmousedown=this.ref.plus.onmousedown=function(t){t.preventDefault(),t.stopPropagation();const e=setInterval((()=>{this.onclick()}),100);return this.onmouseout=this.onmouseup=()=>clearInterval(e),!1};const o=(t,e)=>{let n,r;window.addEventListener("wheel",n=n=>{if(n.stopPropagation(),n.ctrlKey)return void alert("Используй Shift");if(!n.shiftKey)return e(-n.deltaX,-n.deltaY),!1;const r=Number.parseInt(this.ref.scale.value);return n.deltaY>0?(this.ref.scale.value=r+5,t(),!1):(this.ref.scale.value=r-5,t(),!1)}),window.addEventListener("mousedown",r=t=>{let n,r,o=t.x,i=t.y;window.addEventListener("mousemove",n=t=>{t.preventDefault(),t.stopPropagation(),e(t.x-o,t.y-i),o=t.x,i=t.y}),window.addEventListener("mouseup",r=()=>{window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",r)})}),this.onUnmount=()=>{window.removeEventListener("wheel",n),window.removeEventListener("mousedown",r)}};this.ref.close.onclick=()=>{t.expandRoot?.destroy(),t.expandRoot=null,t.appRoot?.mount(t.target)}}}},"SVG-BOX":{prep:{tgn:"DIV",as:"svg-box",attr:{as:"svg-box",class:"screen-box"},ch:[{tgn:"SCREEN-CONTROL",attr:{_ref:"control"},ch:[]},{tgn:"DIV",attr:{style:"cursor: move;",_ref:"content"},ch:[]}],script:function(t,e,n,r){window.oncontextmenu=()=>!1,t.expandRoot=this,this.onSetData=t=>{let e=(t=t.cloneNode(!0)).getAttribute("width"),n=t.getAttribute("height");this.ref.content.appendChild(t),t.setAttribute("viewBox",[0,0,e,n].join(" ")),t.setAttribute("height","100vh"),t.setAttribute("width","100vw");let r=1,o=0,i=0;function s(){return["translate(",o,i,")","scale(",r,")"].join(" ")}this.ref.control.setData({setScale:function(e){const n=r;r=e;const a=r/n;return o*=a,i*=a,t.setAttribute("transform",s()),r},setTranslate:function(e,n){o+=e,i+=n,t.setAttribute("transform",s())},reset:function(){return r=1,o=0,i=0,t.removeAttribute("transform"),r}})}}}},"IMG-BOX":{prep:{tgn:"DIV",as:"img-box",attr:{as:"img-box",class:"screen-box"},ch:[{tgn:"SCREEN-CONTROL",attr:{_ref:"control"},ch:[]},{tgn:"DIV",attr:{style:"cursor: move; text-align:center;height:100%;",_ref:"content"},ch:[]}],script:function(t,e,n,r){window.oncontextmenu=()=>!1,t.expandRoot=this,this.onSetData=t=>{let e=t.width,r=t.height;const o=n.createElement("canvas");o.width=e,o.height=r,o.getContext("2d",{willReadFrequently:!0}).putImageData(t.getContext("2d").getImageData(0,0,e,r),0,0),this.ref.content.appendChild(o);let i=1,s=0,a=0;function c(){if(window.innerWidth/window.innerHeight<o.width/o.height){o.style.width="100vw",o.style.height="";const t=(window.innerHeight-o.offsetHeight)/2;o.style.margin=t+"px 0"}else o.style.width="",o.style.height="100vh",o.style.margin="0"}function l(){return["translate(",s,"px,",a,"px)"," ","scale(",i,")"].join("")}c(),window.addEventListener("resize",c),this.onDestroy=function(){window.removeEventListener("resize",c)},this.ref.control.setData({setScale:function(t){const e=i;i=t;const n=i/e;return s*=n,a*=n,o.style.transform=l(),i},setTranslate:function(t,e){s+=t,a+=e,o.style.transform=l()},reset:function(){return i=1,s=0,a=0,o.style.transform=l(),i}})}}}}})}(t)];return e[0].putModule("expand-screen",e[1],"html"),e[0]})(b).create("app-root").mount(document.body)})()})();